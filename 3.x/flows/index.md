# Ranking Flows

## Overview

Ranking Flows provide a lightweight way to continuously rank items using human comparisons without the overhead of creating full orders. They are ideal for ongoing evaluation where new items are added over time and ranked against existing ones using a bradley terry paired comparison based rating system.

> **Note:** Can be used with Images, Videos, Audio, and Text.

## How to use Ranking Flows

### 1. Create a Flow

Start by creating a ranking flow with an instruction that will be shown to evaluators for each comparison:

```python
from rapidata import RapidataClient

client = RapidataClient()

flow = client.flow.create_ranking_flow(
    name="Image Quality Ranking",
    instruction="Which image looks better?",
)
```

### 2. Add a Flow Batch

Submit datapoints to the flow by creating a batch. Each batch uploads a set of items that will be compared and ranked:

```python
flow_item = flow.create_new_flow_batch(
    datapoints=[
        "https://example.com/image_a.jpg",
        "https://example.com/image_b.jpg",
        "https://example.com/image_c.jpg",
    ],
)
```

You can optionally provide a `context` string that will be shown alongside the instruction, and a `time_to_live` to automatically stop the flow item after a given number of seconds (minimum 60):

```python
flow_item = flow.create_new_flow_batch(
    datapoints=[
        "https://example.com/image_a.jpg",
        "https://example.com/image_b.jpg",
        "https://example.com/image_c.jpg",
    ],
    context="These images were generated by model X",
    time_to_live=300,  # stop after maximum 5 minutes and return partial results
)
```

### 3. Get Results

Call `get_results()` on a flow item to retrieve the ranking results. If the flow item is still processing, this will automatically wait until it completes:

```python
results = flow_item.get_results()
```

You can also check the status without blocking:

```python
status = flow_item.get_status()  # Pending, Running, Completed, Failed, or Stopped
```

To query all flow items for a flow:

```python
all_items = flow.get_flow_items()
```

### 4. Update Flow Configuration

You can update the flow configuration at any time:

```python
flow.update_config(
    instruction="Which image has higher visual quality?",
)
```

> **Note:** This config will only effect new flow items and not modify existing ones.


### Retrieving Existing Flows

You can retrieve flows by ID or list your recent flows:

```python
# Get a specific flow by ID
flow = client.flow.get_flow_by_id("flow_id_here")

# List recent flows
recent_flows = client.flow.find_flows(amount=10)
```

### Deleting a Flow

```python
flow.delete()
```
